<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2024-12-19">

<title>Monte Carlo Simulation Tools for REDD+ Uncertainty Estimates</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="monte-carlo-trees_files/libs/clipboard/clipboard.min.js"></script>
<script src="monte-carlo-trees_files/libs/quarto-html/quarto.js"></script>
<script src="monte-carlo-trees_files/libs/quarto-html/popper.min.js"></script>
<script src="monte-carlo-trees_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="monte-carlo-trees_files/libs/quarto-html/anchor.min.js"></script>
<link href="monte-carlo-trees_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="monte-carlo-trees_files/libs/quarto-html/quarto-syntax-highlighting-0626ff4d7a71b55c8707dcae1d04a9b6.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="monte-carlo-trees_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="monte-carlo-trees_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="monte-carlo-trees_files/libs/bootstrap/bootstrap-561c0044c16d05b43a520218c0aaa88c.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">1</span> Introduction</a>
  <ul>
  <li><a href="#art-requirements-for-monte-carlo-methods" id="toc-art-requirements-for-monte-carlo-methods" class="nav-link" data-scroll-target="#art-requirements-for-monte-carlo-methods"><span class="header-section-number">1.1</span> ART Requirements for Monte Carlo Methods</a></li>
  <li><a href="#current-methods" id="toc-current-methods" class="nav-link" data-scroll-target="#current-methods"><span class="header-section-number">1.2</span> Current Methods</a>
  <ul>
  <li><a href="#current-tools" id="toc-current-tools" class="nav-link" data-scroll-target="#current-tools"><span class="header-section-number">1.2.1</span> Current tools</a></li>
  <li><a href="#current-limitations" id="toc-current-limitations" class="nav-link" data-scroll-target="#current-limitations"><span class="header-section-number">1.2.2</span> Current limitations</a></li>
  </ul></li>
  <li><a href="#sec-1.1" id="toc-sec-1.1" class="nav-link" data-scroll-target="#sec-1.1"><span class="header-section-number">1.3</span> Demonstration script</a>
  <ul>
  <li><a href="#environment-setup" id="toc-environment-setup" class="nav-link" data-scroll-target="#environment-setup"><span class="header-section-number">1.3.1</span> <em>Environment setup</em></a></li>
  </ul></li>
  <li><a href="#import-data" id="toc-import-data" class="nav-link" data-scroll-target="#import-data"><span class="header-section-number">1.4</span> Import data</a></li>
  <li><a href="#probability-density-functions" id="toc-probability-density-functions" class="nav-link" data-scroll-target="#probability-density-functions"><span class="header-section-number">1.5</span> Probability density functions</a></li>
  <li><a href="#simulation-regime" id="toc-simulation-regime" class="nav-link" data-scroll-target="#simulation-regime"><span class="header-section-number">1.6</span> Simulation Regime</a></li>
  <li><a href="#plot-residuals" id="toc-plot-residuals" class="nav-link" data-scroll-target="#plot-residuals"><span class="header-section-number">1.7</span> Plot residuals</a></li>
  <li><a href="#uncertainty-estimates" id="toc-uncertainty-estimates" class="nav-link" data-scroll-target="#uncertainty-estimates"><span class="header-section-number">1.8</span> Uncertainty Estimates</a></li>
  <li><a href="#runtime-snapshot" id="toc-runtime-snapshot" class="nav-link" data-scroll-target="#runtime-snapshot"><span class="header-section-number">1.9</span> Runtime snapshot</a>
  <ul>
  <li><a href="#appendix-i-rapid-literature-review-of-monte-carlo-methods-in-redd" id="toc-appendix-i-rapid-literature-review-of-monte-carlo-methods-in-redd" class="nav-link" data-scroll-target="#appendix-i-rapid-literature-review-of-monte-carlo-methods-in-redd"><span class="header-section-number">1.9.1</span> Appendix I: Rapid literature review of Monte Carlo methods in REDD+</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Monte Carlo Simulation Tools for REDD+ Uncertainty Estimates</h1>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">December 19, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="introduction" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">1</span> Introduction</h2>
<div class="cell" data-layout-ncols="5">

</div>
<p>The ART-TREES Standard V2.01 mandates precise methodologies for calculating and reporting uncertainty estimates associated with emission factors and activity data within jurisdictional and nested REDD+ projects. In response to these requirements, the LEAF-TA program has commissioned the Guyana ART-TREES project team to develop and support capacity building in specific technical areas.</p>
<ul>
<li>Develop Monte Carlo simulation pathways to quantify uncertainty in emission factors and activity data, ensuring consistency with ART-TREES’s emphasis on robust uncertainty analysis and corrective bias assessment.</li>
<li>Use R or other software to create systems that streamline data workflows and enhance accessibility for MRV purposes. Monte Carlo Simulation for Uncertainty Estimation</li>
<li>Document methodologies and provide results in formats compliant with ART-TREES reporting standards.</li>
<li>Prepare technical reports that detail uncertainty estimation methods and database management workflows.</li>
</ul>
<!-- -->
<ul>
<li>Develop and deliver training materials to strengthen stakeholder capacity to use ART-TREES-aligned tools and methodologies.</li>
</ul>
<section id="art-requirements-for-monte-carlo-methods" class="level3" data-number="1.1">
<h3 data-number="1.1" class="anchored" data-anchor-id="art-requirements-for-monte-carlo-methods"><span class="header-section-number">1.1</span> ART Requirements for Monte Carlo Methods</h3>
<p>To reduce risk of over-crediting, the TREES 2.0 Standard (August 2021)<span class="citation" data-cites="artREDDEnvironmentalExcellence2021"><sup><a href="#ref-artREDDEnvironmentalExcellence2021" role="doc-biblioref">1</a></sup></span> outlines requirements for reporting uncertainty in emissions and removals, and adjusting estimates where uncertainty levels exceed the defined threshold of a half-width of a 90% confidence interval between the upper and lower bounds (Relative RMSE ≤ 10%). Monte Carlo simulations are identified as an appropriate methodology due to their capacity to model variance and provide conservative estimates from large-scale higly-variable datasets. Specifically, “Monte Carlo simulations shall use the 90% confidence interval and a simulation n of 10,000” (p.45).</p>
<p><strong>Aggregation of Uncertainty Across Crediting Periods</strong><br>
The TREES Standard provides a level of flexibility in allowing participants to aggregate uncertainty deductions across multiple crediting periods. At the end of each crediting period, participants may calculate a consolidated uncertainty deduction based on the summed gross emissions reductions and removals achieved over their entire ART participation. If prior uncertainty deductions exceeded the aggregated deduction sum for the total period, the over-deducted credits will be issued into the participant’s registry account. This approach aims to incentivize participants to refine data quality and uncertainty estimates.</p>
<p><strong>Exemption for Allometric Estimates</strong><br>
An exemption from requirements for Monte Carlo simulations is granted to allometric modeled estimates. The TREES Standards V2.0 states that “such errors are considered consistent between emissions in the crediting level and crediting periods” which therefore do not materially influence the net results.</p>
<p><strong>Inclusion of Biomass Map Uncertainty</strong><br>
Conversely, uncertainty must be assessed and reported for emissions factors derived from biomass maps, as these datasets directly impact the accuracy of emission estimates. TREES participants are encouraged to adopt best practices, such as those outlined in the CEOS LPV Biomass Protocol 2021, to enhance calibration, validation, and reliability of spatially explicit datasets. In this guidance document, key recommendations for good practices include appropriate scaling, temporally &amp; spatially consistent reference data and remote sensing, and the use of approved error metrics (90% CI or RMSE). In particular, three likely sources of uncertainty in biomass estimation are highlighted separately for consideration in assessing and calibrating predictions<span class="citation" data-cites="duncansonAbovegroundWoodyBiomass2021"><sup><a href="#ref-duncansonAbovegroundWoodyBiomass2021" role="doc-biblioref">2</a></sup></span>.</p>
<ul>
<li>Measurement Uncertainty in tree measurements (i.e DBH and height).</li>
<li>Allometric Model Errors in statistically inferring biomass from from tree measurements</li>
<li>Sampling &amp; Spatial Uncertainty arising from autocorrelation &amp; over-fitting</li>
</ul>
<p><strong>Calculating Uncertainty Deductions</strong><br>
Cited on page 46 of the TREES Standards V2.0, calculations of uncertainty deductions are derived using the following formulae:</p>
<p><span class="math display">\[
UNC_t = (GHG ER_t + GHG REMV_t) \times UA_t \text{.            EQ 10}
\]</span></p>
<table class="caption-top table">
<caption>Table 1: Parameters used in Equation 10</caption>
<colgroup>
<col style="width: 34%">
<col style="width: 65%">
</colgroup>
<tbody>
<tr class="odd">
<td><span class="math inline">\(UNC_t\)</span></td>
<td>Uncertainty deduction for year <span class="math inline">\(t\)</span> (<span class="math inline">\(tCO_2e\)</span>)</td>
</tr>
<tr class="even">
<td><span class="math inline">\(GHG ER_t\)</span></td>
<td>Gross greenhouse gas emissions reductions for year <span class="math inline">\(t\)</span> (<span class="math inline">\(tCO_2e\)</span>)</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(GHG REMV_t\)</span></td>
<td>Gross greenhouse gas removals for year <span class="math inline">\(t\)</span> (<span class="math inline">\(tCO_2e\)</span>)</td>
</tr>
<tr class="even">
<td><span class="math inline">\(UA_t\)</span></td>
<td>The uncertainty adjustment factor for year <span class="math inline">\(t\)</span></td>
</tr>
</tbody>
</table>
<p>The uncertainty adjustment factor (<span class="math inline">\(UAdj_t\)</span>) quantifies the proportional adjustment to emissions reductions and removals based on statistical uncertainty. It is defined as:</p>
<p><span class="math display">\[
UAdj_t = 0.524417 \times \frac{HW_{90\%t}}{1.645006}    \text{.                           EQ 11}
\]</span></p>
<table class="caption-top table">
<caption>Table 2: Parameters used in Equation 11</caption>
<colgroup>
<col style="width: 34%">
<col style="width: 65%">
</colgroup>
<tbody>
<tr class="odd">
<td><span class="math inline">\(90\%\text{ C I}_{t}\)</span></td>
<td>The half-width of 90% confidence interval as percentage of mean</td>
</tr>
<tr class="even">
<td><span class="math inline">\(1.645006\)</span></td>
<td><span class="math inline">\(t\)</span> value for a 90% confidence interval</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(0.524417\)</span></td>
<td>A scaling constant to adjust the proportion.</td>
</tr>
</tbody>
</table>
</section>
<section id="current-methods" class="level3" data-number="1.2">
<h3 data-number="1.2" class="anchored" data-anchor-id="current-methods"><span class="header-section-number">1.2</span> Current Methods</h3>
<p>In Appendix I, annotated results are presented from a rapid literature review of current methodologies and discussions of Monte Carlo simulations of biomass estimations used in REDD+ studies and programs. The search was conducted using keywords including “Monte Carlo simulations,” “biomass estimation,” “carbon stock uncertainty,” and “REDD+ projects”. Variants and combinations of these terms, including “forest carbon accounting” and “allometric uncertainty,” were also explored. Data sources were visited among Scopus, Web of Science, and Google Scholar,and specialized journals in forestry, remote sensing, and carbon management. The temporal window of the review focused on studies published in the last two decades (2003–2023), reflecting the period during which Monte Carlo methods gained prominence in forest biomass estimation and REDD+ research evolved into a critical global framework. Additional attention was given to high-impact reviews and meta-analyses that provide state-of-the-art evaluations of the field.</p>
<p>Summarize review here…</p>
<section id="current-tools" class="level4" data-number="1.2.1">
<h4 data-number="1.2.1" class="anchored" data-anchor-id="current-tools"><span class="header-section-number">1.2.1</span> Current tools</h4>
<ul>
<li>Details of the design and parameters of the existing excel tool are available <a href="https://www.artredd.org/wp-content/uploads/2021/12/MC-4-estimating-ER-from-forests-update-1-1.xlsx">here</a> and <a href="https://winrock.org/wp-content/uploads/2018/02/UncertaintyReport-12.26.17.pdf?utm_source=chatgpt.com">here</a>.</li>
</ul>
</section>
<section id="current-limitations" class="level4" data-number="1.2.2">
<h4 data-number="1.2.2" class="anchored" data-anchor-id="current-limitations"><span class="header-section-number">1.2.2</span> Current limitations</h4>
<ul>
<li></li>
</ul>
<div>

</div>
<div>

</div>
<div>

</div>
</section>
</section>
<section id="sec-1.1" class="level3" data-number="1.3">
<h3 data-number="1.3" class="anchored" data-anchor-id="sec-1.1"><span class="header-section-number">1.3</span> Demonstration script</h3>
<section id="environment-setup" class="level4" data-number="1.3.1">
<h4 data-number="1.3.1" class="anchored" data-anchor-id="environment-setup"><span class="header-section-number">1.3.1</span> <em>Environment setup</em></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>easypackages<span class="sc">::</span><span class="fu">packages</span>(</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"animation"</span>, <span class="st">"BIOMASS"</span>, <span class="st">"caret"</span>, <span class="st">"dataMaid"</span>, <span class="st">"DescTools"</span>, <span class="st">"dplyr"</span>,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"extrafont"</span>, <span class="st">"FawR"</span>, <span class="st">"ForestToolsRS"</span>, <span class="st">"ggplot2"</span>, <span class="st">"htmltools"</span>,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"janitor"</span>, <span class="st">"jsonlite"</span>, <span class="st">"lattice"</span>, <span class="st">"kableExtra"</span>, <span class="st">"kernlab"</span>,</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"knitr"</span>, <span class="st">"Mlmetrics"</span>, <span class="st">"olsrr"</span>, <span class="st">"plotly"</span>, <span class="st">"psych"</span>, <span class="st">"RColorBrewer"</span>,</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"rmarkdown"</span>, <span class="st">"readxl"</span>, <span class="st">"solarizeddox"</span>, <span class="st">"tibble"</span>, <span class="st">"tidymodels"</span>, <span class="st">"tidyverse"</span>,</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"tinytex"</span>, <span class="st">"tune"</span>, <span class="st">"useful"</span>, <span class="st">"webshot"</span>, <span class="st">"webshot2"</span>,</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">prompt =</span> F</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="import-data" class="level3" data-number="1.4">
<h3 data-number="1.4" class="anchored" data-anchor-id="import-data"><span class="header-section-number">1.4</span> Import data</h3>
<p>This section outlines the tools for importing and preparing forestry and biomass data for analysis, a key step in building ART-TREES-compliant MRV systems. Using the <code>allodb</code> package, we load a global allometry database and a dummy dataset from the Smithsonian Institute ForestGEO project.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"allodb"</span>) <span class="co"># https://docs.ropensci.org/allodb/</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">333</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co">#data(ufc) # spuRs::vol.m3(dataset$dbh.cm, dataset$height.m, multiplier = 0.5)</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(scbi_stem1)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>dataset <span class="ot">=</span> scbi_stem1</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dataset) <span class="sc">|&gt;</span> tibble<span class="sc">::</span><span class="fu">as_tibble</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">treeID</th>
<th style="text-align: right;">stemID</th>
<th style="text-align: right;">dbh</th>
<th style="text-align: left;">genus</th>
<th style="text-align: left;">species</th>
<th style="text-align: left;">Family</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2695</td>
<td style="text-align: right;">2695</td>
<td style="text-align: right;">1.41</td>
<td style="text-align: left;">Acer</td>
<td style="text-align: left;">negundo</td>
<td style="text-align: left;">Sapindaceae</td>
</tr>
<tr class="even">
<td style="text-align: right;">1229</td>
<td style="text-align: right;">38557</td>
<td style="text-align: right;">1.67</td>
<td style="text-align: left;">Acer</td>
<td style="text-align: left;">negundo</td>
<td style="text-align: left;">Sapindaceae</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1230</td>
<td style="text-align: right;">1230</td>
<td style="text-align: right;">1.42</td>
<td style="text-align: left;">Acer</td>
<td style="text-align: left;">negundo</td>
<td style="text-align: left;">Sapindaceae</td>
</tr>
<tr class="even">
<td style="text-align: right;">1295</td>
<td style="text-align: right;">32303</td>
<td style="text-align: right;">1.04</td>
<td style="text-align: left;">Acer</td>
<td style="text-align: left;">negundo</td>
<td style="text-align: left;">Sapindaceae</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1229</td>
<td style="text-align: right;">32273</td>
<td style="text-align: right;">2.47</td>
<td style="text-align: left;">Acer</td>
<td style="text-align: left;">negundo</td>
<td style="text-align: left;">Sapindaceae</td>
</tr>
<tr class="even">
<td style="text-align: right;">66</td>
<td style="text-align: right;">31258</td>
<td style="text-align: right;">2.19</td>
<td style="text-align: left;">Acer</td>
<td style="text-align: left;">negundo</td>
<td style="text-align: left;">Sapindaceae</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>psych<span class="sc">::</span><span class="fu">describe</span>(dataset)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 6%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 5%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 2%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">vars</th>
<th style="text-align: right;">n</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">median</th>
<th style="text-align: right;">trimmed</th>
<th style="text-align: right;">mad</th>
<th style="text-align: right;">min</th>
<th style="text-align: right;">max</th>
<th style="text-align: right;">range</th>
<th style="text-align: right;">skew</th>
<th style="text-align: right;">kurtosis</th>
<th style="text-align: right;">se</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">treeID</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2287</td>
<td style="text-align: right;">2778.658067</td>
<td style="text-align: right;">1929.262548</td>
<td style="text-align: right;">2525.00</td>
<td style="text-align: right;">2705.540688</td>
<td style="text-align: right;">2091.9486000</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">6207.00</td>
<td style="text-align: right;">6206.00</td>
<td style="text-align: right;">0.2717859</td>
<td style="text-align: right;">-1.1051173</td>
<td style="text-align: right;">40.3420768</td>
</tr>
<tr class="even">
<td style="text-align: left;">stemID</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2287</td>
<td style="text-align: right;">16577.120682</td>
<td style="text-align: right;">16197.884045</td>
<td style="text-align: right;">5022.00</td>
<td style="text-align: right;">15661.273621</td>
<td style="text-align: right;">5749.5228000</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">40180.00</td>
<td style="text-align: right;">40179.00</td>
<td style="text-align: right;">0.3961204</td>
<td style="text-align: right;">-1.7487292</td>
<td style="text-align: right;">338.7078042</td>
</tr>
<tr class="odd">
<td style="text-align: left;">dbh</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2287</td>
<td style="text-align: right;">5.520162</td>
<td style="text-align: right;">10.803608</td>
<td style="text-align: right;">1.67</td>
<td style="text-align: right;">2.653741</td>
<td style="text-align: right;">0.7857782</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">92.02</td>
<td style="text-align: right;">91.02</td>
<td style="text-align: right;">3.8111843</td>
<td style="text-align: right;">16.3042875</td>
<td style="text-align: right;">0.2259101</td>
</tr>
<tr class="even">
<td style="text-align: left;">genus*</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2287</td>
<td style="text-align: right;">16.372540</td>
<td style="text-align: right;">6.516571</td>
<td style="text-align: right;">18.00</td>
<td style="text-align: right;">16.712725</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">31.00</td>
<td style="text-align: right;">30.00</td>
<td style="text-align: right;">-0.5713109</td>
<td style="text-align: right;">0.1413179</td>
<td style="text-align: right;">0.1362655</td>
</tr>
<tr class="odd">
<td style="text-align: left;">species*</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">2287</td>
<td style="text-align: right;">13.256231</td>
<td style="text-align: right;">9.600139</td>
<td style="text-align: right;">8.00</td>
<td style="text-align: right;">11.305298</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">40.00</td>
<td style="text-align: right;">39.00</td>
<td style="text-align: right;">1.5869799</td>
<td style="text-align: right;">1.2976632</td>
<td style="text-align: right;">0.2007449</td>
</tr>
<tr class="even">
<td style="text-align: left;">Family*</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">2287</td>
<td style="text-align: right;">13.068212</td>
<td style="text-align: right;">4.021778</td>
<td style="text-align: right;">13.00</td>
<td style="text-align: right;">13.334244</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">22.00</td>
<td style="text-align: right;">21.00</td>
<td style="text-align: right;">-0.5763674</td>
<td style="text-align: right;">1.4407792</td>
<td style="text-align: right;">0.0840979</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(dataset)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [2,287 × 6] (S3: tbl_df/tbl/data.frame)
 $ treeID : int [1:2287] 2695 1229 1230 1295 1229 66 2600 4936 1229 1005 ...
 $ stemID : int [1:2287] 2695 38557 1230 32303 32273 31258 2600 4936 36996 1005 ...
 $ dbh    : num [1:2287] 1.41 1.67 1.42 1.04 2.47 ...
 $ genus  : chr [1:2287] "Acer" "Acer" "Acer" "Acer" ...
 $ species: chr [1:2287] "negundo" "negundo" "negundo" "negundo" ...
 $ Family : chr [1:2287] "Sapindaceae" "Sapindaceae" "Sapindaceae" "Sapindaceae" ...</code></pre>
</div>
</div>
<p>Tables 1-3: Smithsonian Institute GEOForest dataset from <code>allodb</code> package (n = 2287)</p>
</section>
<section id="probability-density-functions" class="level3" data-number="1.5">
<h3 data-number="1.5" class="anchored" data-anchor-id="probability-density-functions"><span class="header-section-number">1.5</span> Probability density functions</h3>
<p>Accurate selection of probability density functions (PDFs) is essential for modeling uncertainties in carbon stocks and activity data. This section describes methodologies for fitting PDFs to data, ensuring results are robust and aligned with ART-TREES best practices.</p>
<ul>
<li><p>Use of statistical tests for goodness-of-fit validation.</p></li>
<li><p>Integration of domain expertise to refine parameter selection.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add allometry database</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(equations)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"equations_metadata"</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>show_cols   <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"equation_id"</span>, <span class="st">"equation_taxa"</span>, <span class="st">"equation_allometry"</span>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>eq_tab_acer <span class="ot">=</span> <span class="fu">new_equations</span>(<span class="at">subset_taxa =</span> <span class="st">"Acer"</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(eq_tab_acer[, show_cols])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 13%">
<col style="width: 22%">
<col style="width: 64%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">equation_id</th>
<th style="text-align: left;">equation_taxa</th>
<th style="text-align: left;">equation_allometry</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">a4e4d1</td>
<td style="text-align: left;">Acer saccharum</td>
<td style="text-align: left;">exp(-2.192-0.011<em>dbh+2.67</em>(log(dbh)))</td>
</tr>
<tr class="even">
<td style="text-align: left;">dfc2c7</td>
<td style="text-align: left;">Acer rubrum</td>
<td style="text-align: left;">2.02338*(dbh<sup>2)</sup>1.27612</td>
</tr>
<tr class="odd">
<td style="text-align: left;">eac63e</td>
<td style="text-align: left;">Acer rubrum</td>
<td style="text-align: left;">5.2879*(dbh<sup>2)</sup>1.07581</td>
</tr>
<tr class="even">
<td style="text-align: left;">f49bcb</td>
<td style="text-align: left;">Acer pseudoplatanus</td>
<td style="text-align: left;">exp(-5.644074+(2.5189<em>(log(pi</em>dbh))))</td>
</tr>
<tr class="odd">
<td style="text-align: left;">14bf3d</td>
<td style="text-align: left;">Acer mandshuricum</td>
<td style="text-align: left;">0.0335*(dbh)<sup>1.606+0.0026<em>(dbh)^3.323+0.1222</em>(dbh)</sup>2.310</td>
</tr>
<tr class="even">
<td style="text-align: left;">0c7cd6</td>
<td style="text-align: left;">Acer mono</td>
<td style="text-align: left;">0.0202*(dbh)<sup>1.810+0.0111<em>(dbh)^2.740+0.1156</em>(dbh)</sup>2.336</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute above ground biomass</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>dataset<span class="sc">$</span>agb <span class="ot">=</span> allodb<span class="sc">::</span><span class="fu">get_biomass</span>(</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">dbh     =</span> dataset<span class="sc">$</span>dbh,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">genus   =</span> dataset<span class="sc">$</span>genus,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">species =</span> dataset<span class="sc">$</span>species,</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">coords  =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">78.2</span>, <span class="fl">38.9</span>)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co"># examine dbh ~ agb function</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>dbh_agb <span class="ot">=</span> <span class="fu">lm</span>(dbh <span class="sc">~</span> agb, <span class="at">data =</span> dataset)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="co">#olsrr::ols_test_breusch_pagan(lm(dbh_agb)) #&lt;0.0000</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co">#h = lattice::histogram(dbh ~ agb, data = dataset)</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">x    =</span> dataset<span class="sc">$</span>dbh,</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">y    =</span> dataset<span class="sc">$</span>agb,</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">col  =</span> <span class="fu">factor</span>(scbi_stem1<span class="sc">$</span>genus),</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"DBH (cm)"</span>,</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">"AGB (kg)"</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a><span class="co"># examine univariate distributions</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>h1 <span class="ot">=</span> <span class="fu">hist</span>(dataset<span class="sc">$</span>dbh, <span class="at">breaks=</span><span class="dv">10</span>, <span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>xfit<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="fu">min</span>(dataset<span class="sc">$</span>dbh),<span class="fu">max</span>(dataset<span class="sc">$</span>dbh),<span class="at">length=</span><span class="dv">40</span>)</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>yfit<span class="ot">&lt;-</span><span class="fu">dnorm</span>(xfit,<span class="at">mean=</span><span class="fu">mean</span>(dataset<span class="sc">$</span>dbh),<span class="at">sd=</span><span class="fu">sd</span>(dataset<span class="sc">$</span>dbh))</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>yfit <span class="ot">&lt;-</span> yfit<span class="sc">*</span><span class="fu">diff</span>(h1<span class="sc">$</span>mids[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])<span class="sc">*</span><span class="fu">length</span>(dataset<span class="sc">$</span>dbh)</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(xfit, yfit, <span class="at">col=</span><span class="st">"blue"</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>h2 <span class="ot">=</span> <span class="fu">hist</span>(dataset<span class="sc">$</span>agb, <span class="at">breaks=</span><span class="dv">10</span>, <span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>xfit<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="fu">min</span>(dataset<span class="sc">$</span>agb),<span class="fu">max</span>(dataset<span class="sc">$</span>agb),<span class="at">length=</span><span class="dv">40</span>)</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>yfit<span class="ot">&lt;-</span><span class="fu">dnorm</span>(xfit,<span class="at">mean=</span><span class="fu">mean</span>(dataset<span class="sc">$</span>agb),<span class="at">sd=</span><span class="fu">sd</span>(dataset<span class="sc">$</span>agb))</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>yfit <span class="ot">&lt;-</span> yfit<span class="sc">*</span><span class="fu">diff</span>(h2<span class="sc">$</span>mids[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])<span class="sc">*</span><span class="fu">length</span>(dataset<span class="sc">$</span>agb)</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(xfit, yfit, <span class="at">col=</span><span class="st">"blue"</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(dataset<span class="sc">$</span>dbh) <span class="co"># p&lt;0.00001</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon signed rank test with continuity correction

data:  dataset$dbh
V = 2616328, p-value &lt; 2.2e-16
alternative hypothesis: true location is not equal to 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(dataset<span class="sc">$</span>agb) <span class="co"># p&lt;0.00001</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon signed rank test with continuity correction

data:  dataset$agb
V = 2616328, p-value &lt; 2.2e-16
alternative hypothesis: true location is not equal to 0</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="monte-carlo-trees_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" style="width:33.0%"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="monte-carlo-trees_files/figure-html/unnamed-chunk-2-2.png" class="img-fluid figure-img" style="width:33.0%"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="monte-carlo-trees_files/figure-html/unnamed-chunk-2-3.png" class="img-fluid figure-img" style="width:33.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="simulation-regime" class="level3" data-number="1.6">
<h3 data-number="1.6" class="anchored" data-anchor-id="simulation-regime"><span class="header-section-number">1.6</span> Simulation Regime</h3>
<p>This section introduces the design of the Monte Carlo simulation regime, including:</p>
<ul>
<li><p>Simulation parameters are defined to balance computational efficiency and statistical robustness.</p></li>
<li><p>Cross-validation techniques are employed to evaluate model performance and identify bias or variance.</p></li>
</ul>
<p>The <code>LGOCV</code> acronym used in the <code>caret</code> package functions below stands for “leave one group out cross validation”. We must select the % of test data that is set out from the build upon which the model will be repeatedly trained. Note, the following code applies functions to full dataset without explicit training-test split. <strong>Questions remains on whether we require cross-validation uncertainty estimate to review internal bias, and whether we would like to develop Monte Carlo tools for spatial uncertainty used in Activity Data analysis</strong>. For your consideration, the consultant has previously developed Monte Carlo tools for LULC applications, saved <a href="https://github.com/seamusrobertmurphy/02-lulc-classification">here</a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cross-validation split for bias detection</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co">#samples     = caret::createDataPartition(dataset_tidy$volume, p = 0.80, list = FALSE)</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co">#train_data  = dataset_tidy[samples, ]</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co">#test_data   = dataset_tidy[-samples, ]</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulation pattern &amp; regime</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>monte_carlo <span class="ot">=</span> <span class="fu">trainControl</span>(</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">method    =</span> <span class="st">"LGOCV"</span>,</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">number    =</span> <span class="dv">10</span>,     <span class="co"># number of simulations</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">p         =</span> <span class="fl">0.8</span>)     <span class="co"># percentage resampled</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Training model fit with all covariates (".") &amp; the simulation</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>lm_monte_carlo <span class="ot">=</span> <span class="fu">train</span>(</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">data      =</span> dataset, </span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>  agb <span class="sc">~</span> ., </span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.omit,</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">trControl =</span> monte_carlo)</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>lm_monte_carlo </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Random Forest 

2287 samples
   6 predictor

No pre-processing
Resampling: Repeated Train/Test Splits Estimated (10 reps, 80%) 
Summary of sample sizes: 1832, 1832, 1832, 1832, 1832, 1832, ... 
Resampling results across tuning parameters:

  mtry  RMSE       Rsquared   MAE       
   2    334.91964  0.5977225  114.373822
  47     83.37237  0.9711580   14.009351
  93     49.98649  0.9895214    8.593528

RMSE was used to select the optimal model using the smallest value.
The final value used for the model was mtry = 93.</code></pre>
</div>
</div>
</section>
<section id="plot-residuals" class="level3" data-number="1.7">
<h3 data-number="1.7" class="anchored" data-anchor-id="plot-residuals"><span class="header-section-number">1.7</span> Plot residuals</h3>
<p>To enable access to these predictions, we need to instruct <code>caret</code> to retain the resampled predictions by setting <code>savePredictions = "final"</code> in our <code>trainControl()</code> function. It’s important to be aware that if you’re working with a large dataset or numerous resampling iterations, the resulting <code>train()</code> object may grow significantly in size. This happens because <code>caret</code> must store a record of every row, including both the observed values and predictions, for each resampling iteration. By visualizing the results, we can offer insights into the performance of our model on the resampled data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>monte_carlo_viz <span class="ot">=</span> <span class="fu">trainControl</span>(</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">method    =</span> <span class="st">"LGOCV"</span>, </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">p         =</span> <span class="fl">0.8</span>,            </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">number    =</span> <span class="dv">1</span>,  <span class="co"># just for saving previous results</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">savePredictions =</span> <span class="st">"final"</span>) </span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>lm_monte_carlo_viz <span class="ot">=</span> <span class="fu">train</span>(</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  agb <span class="sc">~</span> ., </span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">data      =</span> dataset, </span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">method    =</span> <span class="st">"lm"</span>,</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.action =</span> na.omit,</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">trControl =</span> monte_carlo_viz)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(lm_monte_carlo_viz<span class="sc">$</span>pred)  <span class="co"># residuals </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">intercept</th>
<th style="text-align: right;">pred</th>
<th style="text-align: right;">obs</th>
<th style="text-align: right;">rowIndex</th>
<th style="text-align: left;">Resample</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">TRUE</td>
<td style="text-align: right;">-39.259595</td>
<td style="text-align: right;">0.2822055</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">Resample1</td>
</tr>
<tr class="even">
<td style="text-align: left;">TRUE</td>
<td style="text-align: right;">-8.616432</td>
<td style="text-align: right;">0.7664882</td>
<td style="text-align: right;">5</td>
<td style="text-align: left;">Resample1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TRUE</td>
<td style="text-align: right;">-31.913620</td>
<td style="text-align: right;">0.5637806</td>
<td style="text-align: right;">6</td>
<td style="text-align: left;">Resample1</td>
</tr>
<tr class="even">
<td style="text-align: left;">TRUE</td>
<td style="text-align: right;">-97.233363</td>
<td style="text-align: right;">0.1832042</td>
<td style="text-align: right;">10</td>
<td style="text-align: left;">Resample1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TRUE</td>
<td style="text-align: right;">356.407185</td>
<td style="text-align: right;">161.5561844</td>
<td style="text-align: right;">20</td>
<td style="text-align: left;">Resample1</td>
</tr>
<tr class="even">
<td style="text-align: left;">TRUE</td>
<td style="text-align: right;">1393.945330</td>
<td style="text-align: right;">1095.2695394</td>
<td style="text-align: right;">22</td>
<td style="text-align: left;">Resample1</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>lm_monte_carlo_viz<span class="sc">$</span>pred <span class="sc">|&gt;</span> </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>pred,<span class="at">y=</span>obs)) <span class="sc">+</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">shape=</span><span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="dv">1</span>, <span class="at">colour=</span><span class="st">'blue'</span>)  <span class="sc">+</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_obs_pred</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="monte-carlo-trees_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="uncertainty-estimates" class="level3" data-number="1.8">
<h3 data-number="1.8" class="anchored" data-anchor-id="uncertainty-estimates"><span class="header-section-number">1.8</span> Uncertainty Estimates</h3>
<p>This section discusses the trade-offs and methodological choices in uncertainty estimation using Monte Carlo simulations. It aligns with ART-TREES principles by:</p>
<ul>
<li><p>Quantifying confidence intervals for emissions estimates.</p></li>
<li><p>Addressing potential biases in the modeling process.</p></li>
<li><p>Ensuring robustness in uncertainty reporting.</p></li>
</ul>
<p><strong><em>Working Notes…</em></strong></p>
<p>References to key studies on cross-validation methods provide a theoretical foundation for the approach.<strong>Monte Carlo cross-validation</strong> (MCCV) involves randomly dividing the dataset into two parts: a training subset and a validation subset, without reusing data points. The model is trained on the training subset, denoted as ( n_t ), and assessed on the validation subset, ( n_v ). While there are ( ) distinct ways to form the training subsets, MCCV bypasses the computational burden of evaluating all these combinations by sampling a smaller number of iterations. Zhang <span class="math display">\[3\]</span> demonstrated that performing MCCV for ( N ) iterations yields results comparable to exhaustive cross-validation over all possible subsets. However, studies investigating MCCV for large dataset sizes (( N )) remain limited.</p>
<p>The trade-off between bias and variance in MCCV is influenced by the choice of ( k ) (iterations) and ( n_t ) (training subset size). Increasing ( k ) or ( n_t ) tends to reduce bias but increases variance. Larger training subsets lead to greater similarity across iterations, which can result in overfitting to the training data. For a deeper analysis, see <span class="math display">\[2\]</span>. The bias-variance characteristics of ( k )-fold cross-validation (kFCV) and MCCV differ, but their bias levels can be aligned by selecting appropriate values for ( k ) and ( n_t ). A detailed comparison of the bias and variance for both approaches can be found in <span class="math display">\[1\]</span>, where MCCV is referred to as the “repeated-learning testing-model.”</p>
<p>Monte Carlo Simulation in LULC Classification of Activity Data Assessment:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ForesToolboxRS)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dir.create</span>(<span class="st">"./data/testdata"</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fu">download.file</span>(<span class="st">"https://github.com/ytarazona/ft_data/raw/main/data/LC08_232066_20190727_SR.zip"</span>,<span class="at">destfile =</span> <span class="st">"testdata/LC08_232066_20190727_SR.zip"</span>)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="fu">unzip</span>(<span class="st">"testdata/LC08_232066_20190727_SR.zip"</span>, <span class="at">exdir =</span> <span class="st">"testdata"</span>) <span class="fu">download.file</span>(<span class="st">"https://github.com/ytarazona/ft_data/raw/main/data/signatures.zip"</span>, <span class="at">destfile =</span> <span class="st">"testdata/signatures.zip"</span>)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="fu">unzip</span>(<span class="st">"testdata/signatures.zip"</span>, <span class="at">exdir =</span> <span class="st">"testdata"</span>)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>image <span class="ot">&lt;-</span> <span class="fu">stack</span>(<span class="st">"./data/testdata/LC08_232066_20190727_SR.tif"</span>)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>sig <span class="ot">&lt;-</span> <span class="fu">read_sf</span>(<span class="st">"./data/testdata/signatures.shp"</span>)</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>classRF <span class="ot">&lt;-</span> <span class="fu">mla</span>(<span class="at">img =</span> image, <span class="at">model =</span> <span class="st">"randomForest"</span>, <span class="at">endm =</span> sig, <span class="at">training_split =</span> <span class="dv">80</span>)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(classRF)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Classification</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>colmap <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#0000FF"</span>,<span class="st">"#228B22"</span>,<span class="st">"#FF1493"</span>, <span class="st">"#00FF00"</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(classRF<span class="sc">$</span>Classification, <span class="at">main =</span> <span class="st">"RandomForest Classification"</span>, <span class="at">col =</span> colmap, <span class="at">axes =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="02-lulc-classification/figure-html/unnamed-chunk-3-1.png" class="img-fluid"></p>
<p><img src="02-lulc-classification_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  cal_ml<span class="sc">$</span>svm_mccv,</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Monte Carlo Cross-Validation calibration"</span>,</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">"darkmagenta"</span>,</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"b"</span>,</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.4</span>),</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">"Error between 0 and 1"</span>,</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"Number of iterations"</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(cal_ml<span class="sc">$</span>randomForest_mccv, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">type =</span> <span class="st">"b"</span>)</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(cal_ml<span class="sc">$</span>naiveBayes_mccv, <span class="at">col =</span> <span class="st">"green"</span>, <span class="at">type =</span> <span class="st">"b"</span>)</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(cal_ml<span class="sc">$</span>knn_mccv, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">type =</span> <span class="st">"b"</span>)</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>  <span class="st">"topleft"</span>,</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Support Vector Machine"</span>,</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Random Forest"</span>,</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Naive Bayes"</span>,</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">"K-nearest Neighbors"</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"darkmagenta"</span>, <span class="st">"red"</span>, <span class="st">"green"</span>, <span class="st">"blue"</span>),</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">lty =</span> <span class="dv">1</span>,</span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">cex =</span> <span class="fl">0.7</span></span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="02-lulc-classification/figure-html/unnamed-chunk-5-1.png" class="img-fluid"></p>
<hr>
<p>Burman, P. (1989). A comparative study of ordinary cross-validation, ( v )-fold cross-validation, and the repeated learning testing-model methods. <em>Biometrika</em>, <strong>76</strong>, 503–514.</p>
<p>Hastie, T., Tibshirani, R., &amp; Friedman, J. (2011). <em>The Elements of Statistical Learning: Data Mining, Inference, and Prediction</em>. 2nd ed.&nbsp;New York: Springer.</p>
<p>Zhang, P. (1993). Model selection via multifold cross-validation. <em>Annals of Statistics</em>, <strong>21</strong>, 299–313.</p>
</section>
<section id="runtime-snapshot" class="level3" data-number="1.9">
<h3 data-number="1.9" class="anchored" data-anchor-id="runtime-snapshot"><span class="header-section-number">1.9</span> Runtime snapshot</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">session_info</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>─ Session info ───────────────────────────────────────────────────────────────
 setting  value
 version  R version 4.4.2 (2024-10-31)
 os       Fedora Linux 40 (Workstation Edition)
 system   x86_64, linux-gnu
 ui       X11
 language (EN)
 collate  en_CA.UTF-8
 ctype    en_CA.UTF-8
 tz       America/Vancouver
 date     2024-12-20
 pandoc   3.1.3 @ /usr/libexec/rstudio/bin/pandoc/ (via rmarkdown)

─ Packages ───────────────────────────────────────────────────────────────────
 package      * version    date (UTC) lib source
 abind          1.4-8      2024-09-12 [2] CRAN (R 4.4.1)
 allodb       * 0.0.1.9000 2024-12-19 [1] Github (ropensci/allodb@4207f86)
 animation    * 2.7        2021-10-07 [2] CRAN (R 4.4.0)
 assertthat     0.2.1      2019-03-21 [2] CRAN (R 4.4.0)
 backports      1.5.0      2024-05-23 [2] CRAN (R 4.4.0)
 BIOMASS      * 2.1.11     2023-09-29 [2] CRAN (R 4.4.0)
 boot           1.3-31     2024-08-28 [2] CRAN (R 4.4.1)
 broom        * 1.0.7      2024-09-26 [2] CRAN (R 4.4.1)
 cachem         1.1.0      2024-05-16 [2] CRAN (R 4.4.0)
 car            3.1-3      2024-09-27 [2] CRAN (R 4.4.1)
 carData        3.0-5      2022-01-06 [2] CRAN (R 4.4.0)
 caret        * 7.0-1      2024-12-10 [2] CRAN (R 4.4.2)
 cellranger     1.1.0      2016-07-27 [2] CRAN (R 4.4.0)
 chromote       0.3.1      2024-08-30 [2] CRAN (R 4.4.1)
 class          7.3-22     2023-05-03 [2] CRAN (R 4.4.0)
 classInt       0.4-10     2023-09-05 [2] CRAN (R 4.4.0)
 cli            3.6.3      2024-06-21 [2] CRAN (R 4.4.0)
 codetools      0.2-20     2024-03-31 [2] CRAN (R 4.4.0)
 colorspace     2.1-1      2024-07-26 [2] CRAN (R 4.4.1)
 CoprManager    0.5.7      2024-10-31 [4] local
 data.table     1.16.4     2024-12-06 [2] CRAN (R 4.4.2)
 dataMaid     * 1.4.1      2021-10-08 [2] CRAN (R 4.4.1)
 DBI            1.2.3      2024-06-02 [2] CRAN (R 4.4.0)
 DEoptimR       1.1-3-1    2024-11-23 [2] CRAN (R 4.4.2)
 DescTools    * 0.99.58    2024-11-08 [2] CRAN (R 4.4.1)
 devtools       2.4.5      2022-10-11 [2] CRAN (R 4.4.0)
 dials        * 1.3.0      2024-07-30 [2] CRAN (R 4.4.1)
 DiceDesign     1.10       2023-12-07 [2] CRAN (R 4.4.0)
 digest         0.6.37     2024-08-19 [2] CRAN (R 4.4.1)
 dplyr        * 1.1.4      2023-11-17 [2] CRAN (R 4.4.0)
 e1071          1.7-16     2024-09-16 [2] CRAN (R 4.4.1)
 easypackages   0.1.0      2016-12-05 [2] CRAN (R 4.4.0)
 ellipsis       0.3.2      2021-04-29 [2] CRAN (R 4.4.0)
 evaluate       1.0.1      2024-10-10 [2] CRAN (R 4.4.1)
 Exact          3.3        2024-07-21 [2] CRAN (R 4.4.1)
 expm           1.0-0      2024-08-19 [2] CRAN (R 4.4.1)
 extrafont    * 0.19       2023-01-18 [2] CRAN (R 4.4.0)
 extrafontdb    1.0        2012-06-11 [2] CRAN (R 4.4.0)
 farver         2.1.2      2024-05-13 [2] CRAN (R 4.4.0)
 fastmap        1.2.0      2024-05-15 [2] CRAN (R 4.4.0)
 forcats      * 1.0.0      2023-01-29 [2] CRAN (R 4.4.0)
 foreach        1.5.2      2022-02-02 [2] CRAN (R 4.4.0)
 Formula        1.2-5      2023-02-24 [2] CRAN (R 4.4.0)
 fs             1.6.5      2024-10-30 [2] CRAN (R 4.4.1)
 furrr          0.3.1      2022-08-15 [2] CRAN (R 4.4.0)
 future         1.34.0     2024-07-29 [2] CRAN (R 4.4.1)
 future.apply   1.11.3     2024-10-27 [2] CRAN (R 4.4.1)
 generics       0.1.3      2022-07-05 [2] CRAN (R 4.4.0)
 ggplot2      * 3.5.1      2024-04-23 [2] CRAN (R 4.4.0)
 gld            2.6.6      2022-10-23 [2] CRAN (R 4.4.0)
 globals        0.16.3     2024-03-08 [2] CRAN (R 4.4.0)
 glue           1.8.0      2024-09-30 [2] CRAN (R 4.4.1)
 goftest        1.2-3      2021-10-07 [2] CRAN (R 4.4.0)
 gower          1.0.2      2024-12-17 [2] CRAN (R 4.4.2)
 GPfit          1.0-8      2019-02-08 [2] CRAN (R 4.4.0)
 gridExtra      2.3        2017-09-09 [2] CRAN (R 4.4.0)
 gtable         0.3.6      2024-10-25 [2] CRAN (R 4.4.1)
 hardhat        1.4.0      2024-06-02 [2] CRAN (R 4.4.0)
 haven          2.5.4      2023-11-30 [2] CRAN (R 4.4.0)
 hms            1.1.3      2023-03-21 [2] CRAN (R 4.4.0)
 htmltools    * 0.5.8.1    2024-04-04 [2] CRAN (R 4.4.0)
 htmlwidgets    1.6.4      2023-12-06 [2] CRAN (R 4.4.0)
 httpuv         1.6.15     2024-03-26 [2] CRAN (R 4.4.0)
 httr           1.4.7      2023-08-15 [2] CRAN (R 4.4.0)
 infer        * 1.0.7      2024-03-25 [2] CRAN (R 4.4.0)
 ipred          0.9-15     2024-07-18 [2] CRAN (R 4.4.1)
 iterators      1.0.14     2022-02-05 [2] CRAN (R 4.4.0)
 janitor      * 2.2.0      2023-02-02 [2] CRAN (R 4.4.0)
 jsonlite     * 1.8.9      2024-09-20 [2] CRAN (R 4.4.1)
 kableExtra   * 1.4.0      2024-01-24 [2] CRAN (R 4.4.0)
 kernlab      * 0.9-33     2024-08-13 [2] CRAN (R 4.4.1)
 KernSmooth     2.23-24    2024-05-17 [2] CRAN (R 4.4.0)
 knitr        * 1.49       2024-11-08 [2] CRAN (R 4.4.1)
 labeling       0.4.3      2023-08-29 [2] CRAN (R 4.4.0)
 later          1.4.1      2024-11-27 [2] CRAN (R 4.4.2)
 lattice      * 0.22-6     2024-03-20 [2] CRAN (R 4.4.0)
 lava           1.8.0      2024-03-05 [2] CRAN (R 4.4.0)
 lazyeval       0.2.2      2019-03-15 [2] CRAN (R 4.4.0)
 lhs            1.2.0      2024-06-30 [2] CRAN (R 4.4.1)
 lifecycle      1.0.4      2023-11-07 [2] CRAN (R 4.4.0)
 listenv        0.9.1      2024-01-29 [2] CRAN (R 4.4.0)
 lmom           3.2        2024-09-30 [2] CRAN (R 4.4.1)
 lubridate    * 1.9.4      2024-12-08 [2] CRAN (R 4.4.2)
 magrittr       2.0.3      2022-03-30 [2] CRAN (R 4.4.0)
 MASS           7.3-61     2024-06-13 [2] CRAN (R 4.4.0)
 Matrix         1.7-1      2024-10-18 [2] CRAN (R 4.4.1)
 memoise        2.0.1      2021-11-26 [2] CRAN (R 4.4.0)
 mime           0.12       2021-09-28 [2] CRAN (R 4.4.0)
 miniUI         0.1.1.1    2018-05-18 [2] CRAN (R 4.4.0)
 minpack.lm     1.2-4      2023-09-11 [2] CRAN (R 4.4.0)
 mnormt         2.1.1      2022-09-26 [2] CRAN (R 4.4.0)
 modeldata    * 1.4.0      2024-06-19 [2] CRAN (R 4.4.0)
 ModelMetrics   1.2.2.2    2020-03-17 [2] CRAN (R 4.4.0)
 munsell        0.5.1      2024-04-01 [2] CRAN (R 4.4.0)
 mvtnorm        1.3-2      2024-11-04 [2] CRAN (R 4.4.1)
 nlme           3.1-166    2024-08-14 [2] CRAN (R 4.4.1)
 nnet           7.3-19     2023-05-03 [2] CRAN (R 4.4.0)
 nortest        1.0-4      2015-07-30 [2] CRAN (R 4.4.0)
 olsrr        * 0.6.1      2024-11-06 [2] CRAN (R 4.4.1)
 pander         0.6.5      2022-03-18 [2] CRAN (R 4.4.0)
 parallelly     1.41.0     2024-12-18 [2] CRAN (R 4.4.2)
 parsnip      * 1.2.1      2024-03-22 [2] CRAN (R 4.4.0)
 pillar         1.10.0     2024-12-17 [2] CRAN (R 4.4.2)
 pkgbuild       1.4.5      2024-10-28 [2] CRAN (R 4.4.1)
 pkgconfig      2.0.3      2019-09-22 [2] CRAN (R 4.4.0)
 pkgload        1.4.0      2024-06-28 [2] CRAN (R 4.4.1)
 plotly       * 4.10.4     2024-01-13 [2] CRAN (R 4.4.0)
 plyr           1.8.9      2023-10-02 [2] CRAN (R 4.4.0)
 pROC           1.18.5     2023-11-01 [2] CRAN (R 4.4.0)
 processx       3.8.4      2024-03-16 [2] CRAN (R 4.4.0)
 prodlim        2024.06.25 2024-06-24 [2] CRAN (R 4.4.0)
 profvis        0.4.0      2024-09-20 [2] CRAN (R 4.4.1)
 promises       1.3.2      2024-11-28 [2] CRAN (R 4.4.2)
 proxy          0.4-27     2022-06-09 [2] CRAN (R 4.4.0)
 ps             1.8.1      2024-10-28 [2] CRAN (R 4.4.1)
 psych        * 2.4.6.26   2024-06-27 [2] CRAN (R 4.4.1)
 purrr        * 1.0.2      2023-08-10 [2] CRAN (R 4.4.0)
 R6             2.5.1      2021-08-19 [2] CRAN (R 4.4.0)
 randomForest   4.7-1.2    2024-09-22 [2] CRAN (R 4.4.1)
 rappdirs       0.3.3      2021-01-31 [2] CRAN (R 4.4.1)
 RColorBrewer * 1.1-3      2022-04-03 [2] CRAN (R 4.4.0)
 Rcpp           1.0.13-1   2024-11-02 [2] CRAN (R 4.4.1)
 readr        * 2.1.5      2024-01-10 [2] CRAN (R 4.4.0)
 readxl       * 1.4.3      2023-07-06 [2] CRAN (R 4.4.0)
 recipes      * 1.1.0      2024-07-04 [2] CRAN (R 4.4.1)
 remotes        2.5.0      2024-03-17 [2] CRAN (R 4.4.0)
 reshape2       1.4.4      2020-04-09 [2] CRAN (R 4.4.0)
 rlang          1.1.4      2024-06-04 [2] CRAN (R 4.4.0)
 rmarkdown    * 2.29       2024-11-04 [1] CRAN (R 4.4.2)
 robustbase     0.99-4-1   2024-09-27 [2] CRAN (R 4.4.1)
 rootSolve      1.8.2.4    2023-09-21 [2] CRAN (R 4.4.0)
 rpart          4.1.23     2023-12-05 [2] CRAN (R 4.4.0)
 rsample      * 1.2.1      2024-03-25 [2] CRAN (R 4.4.0)
 rstudioapi     0.17.1     2024-10-22 [2] CRAN (R 4.4.1)
 Rttf2pt1       1.3.12     2023-01-22 [2] CRAN (R 4.4.0)
 scales       * 1.3.0      2023-11-28 [2] CRAN (R 4.4.0)
 sessioninfo    1.2.2      2021-12-06 [2] CRAN (R 4.4.0)
 sf             1.0-19     2024-11-05 [2] CRAN (R 4.4.2)
 shiny          1.10.0     2024-12-14 [2] CRAN (R 4.4.2)
 snakecase      0.11.1     2023-08-27 [2] CRAN (R 4.4.0)
 stringi        1.8.4      2024-05-06 [2] CRAN (R 4.4.0)
 stringr      * 1.5.1      2023-11-14 [2] CRAN (R 4.4.0)
 survival       3.8-3      2024-12-17 [2] CRAN (R 4.4.2)
 svglite        2.1.3      2023-12-08 [2] CRAN (R 4.4.0)
 systemfonts    1.1.0      2024-05-15 [2] CRAN (R 4.4.0)
 terra          1.8-5      2024-12-12 [2] CRAN (R 4.4.2)
 tibble       * 3.2.1      2023-03-20 [2] CRAN (R 4.4.0)
 tidymodels   * 1.2.0      2024-03-25 [2] CRAN (R 4.4.0)
 tidyr        * 1.3.1      2024-01-24 [2] CRAN (R 4.4.0)
 tidyselect     1.2.1      2024-03-11 [2] CRAN (R 4.4.0)
 tidyverse    * 2.0.0      2023-02-22 [2] CRAN (R 4.4.0)
 timechange     0.3.0      2024-01-18 [2] CRAN (R 4.4.1)
 timeDate       4041.110   2024-09-22 [2] CRAN (R 4.4.1)
 tinytex      * 0.54       2024-11-01 [2] CRAN (R 4.4.1)
 tune         * 1.2.1      2024-04-18 [2] CRAN (R 4.4.0)
 tzdb           0.4.0      2023-05-12 [2] CRAN (R 4.4.0)
 units          0.8-5      2023-11-28 [2] CRAN (R 4.4.0)
 urlchecker     1.0.1      2021-11-30 [2] CRAN (R 4.4.0)
 useful       * 1.2.6.1    2023-10-24 [2] CRAN (R 4.4.0)
 usethis        3.1.0      2024-11-26 [2] CRAN (R 4.4.2)
 vctrs          0.6.5      2023-12-01 [2] CRAN (R 4.4.0)
 viridisLite    0.4.2      2023-05-02 [2] CRAN (R 4.4.0)
 webshot      * 0.5.5      2023-06-26 [2] CRAN (R 4.4.0)
 webshot2     * 0.1.1      2023-08-11 [2] CRAN (R 4.4.0)
 websocket      1.4.2      2024-07-22 [2] CRAN (R 4.4.1)
 withr          3.0.2      2024-10-28 [2] CRAN (R 4.4.1)
 workflows    * 1.1.4      2024-02-19 [2] CRAN (R 4.4.0)
 workflowsets * 1.1.0      2024-03-21 [2] CRAN (R 4.4.0)
 xfun           0.49       2024-10-31 [2] CRAN (R 4.4.1)
 xml2           1.3.6      2023-12-04 [2] CRAN (R 4.4.0)
 xtable         1.8-4      2019-04-21 [2] CRAN (R 4.4.0)
 yaml           2.3.10     2024-07-26 [2] CRAN (R 4.4.1)
 yardstick    * 1.3.1      2024-03-21 [2] CRAN (R 4.4.0)

 [1] /home/seamus/R/x86_64-redhat-linux-gnu-library/4.4
 [2] /usr/local/lib/R/library
 [3] /usr/lib64/R/library
 [4] /usr/share/R/library

──────────────────────────────────────────────────────────────────────────────</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.getenv</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>CHROME_DESKTOP          RStudio.desktop
CLICOLOR_FORCE          1
DBUS_SESSION_BUS_ADDRESS
                        unix:path=/run/user/1000/bus
DEBUGINFOD_IMA_CERT_PATH
                        /etc/keys/ima:
DEBUGINFOD_URLS         https://debuginfod.fedoraproject.org/
DENO_DOM_PLUGIN         /usr/libexec/quarto/bin/tools/x86_64/deno_dom/libplugin.so
DENO_NO_UPDATE_CHECK    1
DENO_TLS_CA_STORE       system,mozilla
DESKTOP_SESSION         gnome
DISPLAY                 :0
EARTHENGINE_ENV         ./
EARTHENGINE_PYTHON      ./bin/python3
EDITOR                  /usr/bin/nano
GDK_BACKEND             x11
GDM_LANG                en_CA.UTF-8
GDMSESSION              gnome
GIO_LAUNCHED_DESKTOP_FILE
                        /usr/share/applications/rstudio.desktop
GIO_LAUNCHED_DESKTOP_FILE_PID
                        11160
GIT_ASKPASS             rpostback-askpass
GNOME_SETUP_DISPLAY     :1
HISTCONTROL             ignoredups
HISTSIZE                1000
HOME                    /home/seamus
HOSTNAME                fedora
INVOCATION_ID           562eb973fc09416dae9f796e5532a7d5
JOURNAL_STREAM          9:114154
LANG                    en_CA.UTF-8
LD_LIBRARY_PATH         /usr/lib64/R/lib:/usr/lib/jvm/jre/lib/server:/usr/lib64/R/lib:/usr/lib/jvm/jre/lib/server
LESSOPEN                ||/usr/bin/lesspipe.sh %s
LN_S                    ln -s
LOGNAME                 seamus
MAIL                    /var/spool/mail/seamus
MAKE                    make
MANAGERPID              2018
MEMORY_PRESSURE_WATCH   /sys/fs/cgroup/user.slice/user-1000.slice/user@1000.service/app.slice/dbus-:1.2-org.gnome.Nautilus@2.service/memory.pressure
MEMORY_PRESSURE_WRITE   c29tZSAyMDAwMDAgMjAwMDAwMAA=
MOZ_GMP_PATH            /usr/lib64/mozilla/plugins/gmp-gmpopenh264/system-installed
MPLENGINE               tkAgg
NO_AT_BRIDGE            1
ORIGINAL_XDG_CURRENT_DESKTOP
                        GNOME
PAGER                   /usr/bin/less
PATH                    /home/seamus/.local/bin:/home/seamus/bin:/usr/local/bin:/usr/local/sbin:/usr/bin:/usr/sbin:/usr/libexec/quarto/bin:/usr/libexec/rstudio/bin/postback
PKGLOAD_PARENT_TEMPDIR
                        /tmp/RtmpWDvlwY
PWD                     /home/seamus/repos/monte-carlo-trees
PYTHONIOENCODING        utf-8
QT_IM_MODULE            ibus
QUARTO_BIN_PATH         /usr/libexec/quarto/bin
QUARTO_CROSSREF_INDEX_PATH
                        /home/seamus/repos/monte-carlo-trees/.Rproj.user/4BF3B1F2/quarto-crossref/48715372
QUARTO_DENO             /usr/libexec/quarto/bin/tools/x86_64/deno
QUARTO_DOCUMENT_PATH    .
QUARTO_PROJECT_ROOT     /home/seamus/repos/monte-carlo-trees
QUARTO_RENDER_TOKEN     13596b09-8c33-41fa-a5a5-63faa8928d55
QUARTO_ROOT             /usr
QUARTO_SHARE_PATH       /usr/libexec/quarto/share
R_ARCH                  
R_BROWSER               /usr/bin/xdg-open
R_BZIPCMD               /usr/bin/bzip2
R_CLI_HAS_HYPERLINK_IDE_HELP
                        true
R_CLI_HAS_HYPERLINK_IDE_RUN
                        true
R_CLI_HAS_HYPERLINK_IDE_VIGNETTE
                        true
R_DOC_DIR               /usr/share/doc/R
R_GZIPCMD               /usr/bin/gzip
R_HOME                  /usr/lib64/R
R_INCLUDE_DIR           /usr/include/R
R_LIBS_SITE             /usr/local/lib/R/site-library:/usr/local/lib/R/library:/usr/lib64/R/library:/usr/share/R/library
R_LIBS_USER             /home/seamus/R/x86_64-redhat-linux-gnu-library/4.4
R_PAPERSIZE             a4
R_PAPERSIZE_USER        a4
R_PDFVIEWER             /usr/bin/xdg-open
R_PLATFORM              x86_64-redhat-linux-gnu
R_PRINTCMD              
R_RD4PDF                times,inconsolata,hyper
R_RUNTIME               
R_SESSION_TMPDIR        /tmp/RtmpWDvlwY
R_SHARE_DIR             /usr/share/R
R_STRIP_SHARED_LIB      strip --strip-unneeded
R_STRIP_STATIC_LIB      strip --strip-debug
R_TEXI2DVICMD           /usr/bin/texi2dvi
R_UNZIPCMD              /usr/bin/unzip
R_ZIPCMD                /usr/bin/zip
RETICULATE_MINICONDA_ENABLED
                        
RMARKDOWN_MATHJAX_PATH
                        /usr/libexec/rstudio/resources/mathjax-27
RS_LOG_LEVEL            WARN
RS_RPOSTBACK_PATH       /usr/libexec/rstudio/bin/rpostback
RS_SHARED_SECRET        be264275-5db5-405a-8d12-faee7fff9e7e
RSTUDIO                 1
RSTUDIO_CHILD_PROCESS_PANE
                        job
RSTUDIO_CLI_HYPERLINKS
                        true
RSTUDIO_CONSOLE_COLOR   256
RSTUDIO_CONSOLE_WIDTH   99
RSTUDIO_DESKTOP_EXE     /usr/libexec/rstudio/rstudio
RSTUDIO_PANDOC          /usr/libexec/rstudio/bin/pandoc
RSTUDIO_PROGRAM_MODE    desktop
RSTUDIO_SESSION_PID     12272
RSTUDIO_SESSION_PORT    21527
RSTUDIO_USER_IDENTITY   seamus
SED                     /usr/bin/sed
SESSION_MANAGER         local/unix:@/tmp/.ICE-unix/2215,unix/unix:/tmp/.ICE-unix/2215
SHELL                   /bin/bash
SHLVL                   1
SSH_AUTH_SOCK           /run/user/1000/keyring/ssh
SYSTEMD_EXEC_PID        9540
TAR                     /usr/bin/gtar
TERM                    xterm-256color
TZDIR                   /usr/share/zoneinfo
USER                    seamus
USERNAME                seamus
WAYLAND_DISPLAY         wayland-0
XAUTHORITY              /run/user/1000/.mutter-Xwaylandauth.X2XWY2
XDG_CURRENT_DESKTOP     GNOME
XDG_DATA_DIRS           /home/seamus/.local/share/flatpak/exports/share:/var/lib/flatpak/exports/share:/usr/local/share/:/usr/share/
XDG_MENU_PREFIX         gnome-
XDG_RUNTIME_DIR         /run/user/1000
XDG_SESSION_CLASS       user
XDG_SESSION_DESKTOP     gnome
XDG_SESSION_TYPE        wayland
XMODIFIERS              @im=ibus
ZOTERO_API              YLGf46K04lL7uCAcolJ6V62G</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">.libPaths</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "/home/seamus/R/x86_64-redhat-linux-gnu-library/4.4"
[2] "/usr/local/lib/R/library"                          
[3] "/usr/lib64/R/library"                              
[4] "/usr/share/R/library"                              </code></pre>
</div>
</div>
<section id="appendix-i-rapid-literature-review-of-monte-carlo-methods-in-redd" class="level4" data-number="1.9.1">
<h4 data-number="1.9.1" class="anchored" data-anchor-id="appendix-i-rapid-literature-review-of-monte-carlo-methods-in-redd"><span class="header-section-number">1.9.1</span> Appendix I: Rapid literature review of Monte Carlo methods in REDD+</h4>
<table class="caption-top table">
<caption>Table 3: Search parameters used in a review of Monte Carlo tools in REDD+ reporting.</caption>
<colgroup>
<col style="width: 26%">
<col style="width: 73%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Parameter</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Keywords</strong></td>
<td>Monte Carlo simulations</td>
</tr>
<tr class="even">
<td></td>
<td>Biomass estimation</td>
</tr>
<tr class="odd">
<td></td>
<td>Carbon stock uncertainty</td>
</tr>
<tr class="even">
<td></td>
<td>REDD+ projects</td>
</tr>
<tr class="odd">
<td></td>
<td>Forest carbon accounting</td>
</tr>
<tr class="even">
<td></td>
<td>Allometric uncertainty</td>
</tr>
<tr class="odd">
<td><strong>Data Sources</strong></td>
<td>Scopus</td>
</tr>
<tr class="even">
<td></td>
<td>Web of Science</td>
</tr>
<tr class="odd">
<td></td>
<td>Google Scholar</td>
</tr>
<tr class="even">
<td></td>
<td>Grey Literature from REDD+ working groups (i.e.&nbsp;UNFCCC, IPCC)</td>
</tr>
<tr class="odd">
<td><strong>Temporal Window</strong></td>
<td>2003–2023</td>
</tr>
<tr class="even">
<td><strong>Focus Areas</strong></td>
<td>Applications of Monte Carlo simulations in biomass and carbon stock estimations.</td>
</tr>
<tr class="odd">
<td></td>
<td>Addressing uncertainty in input data (e.g., allometric equations, plot-level measurements).</td>
</tr>
<tr class="even">
<td></td>
<td>Integration of Monte Carlo methods in REDD+ policy frameworks and carbon accounting.</td>
</tr>
<tr class="odd">
<td><strong>Inclusion Criteria</strong></td>
<td>Peer-reviewed articles and high-impact reviews</td>
</tr>
<tr class="even">
<td></td>
<td>Case studies and empirical research involving REDD+ projects.</td>
</tr>
<tr class="odd">
<td></td>
<td>Discussions of methodological advancements or critiques of Monte Carlo approaches.</td>
</tr>
</tbody>
</table>
<table class="caption-top table">
<caption>Table 4: Results of a review of literature on Monte Carlo methodologies in REDD+ projects.</caption>
<colgroup>
<col style="width: 19%">
<col style="width: 19%">
<col style="width: 19%">
<col style="width: 22%">
<col style="width: 19%">
</colgroup>
<thead>
<tr class="header">
<th><strong>REDD+ scheme</strong><a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></th>
<th><strong>Monte Carlo applied</strong></th>
<th><strong>Region</strong></th>
<th><strong>Key Findings</strong></th>
<th><strong>Ref</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>ADD</td>
<td>Uncertainty of SAAB estimate</td>
<td>Rondônia, Brazil</td>
<td>Estimated ± 20% measurement error in SAAB using Monte Carlo simulations; emphasized large trees’ role in biomass.</td>
<td><span class="citation" data-cites="brown1995a"><sup><a href="#ref-brown1995a" role="doc-biblioref">3</a></sup></span></td>
</tr>
<tr class="even">
<td>ADD</td>
<td>AGB Uncertainty</td>
<td>Kenya, Mozambique</td>
<td>Assessed mixed-effects models in estimating mangrove biomass.</td>
<td><span class="citation" data-cites="cohen2013a"><sup><a href="#ref-cohen2013a" role="doc-biblioref">4</a></sup></span></td>
</tr>
<tr class="odd">
<td>ADD</td>
<td>Blanket uncertainty propagation</td>
<td>Ghana</td>
<td>AGB prediction error &gt;20%; addressed error propagation from trees to pixels in remote sensing.</td>
<td><span class="citation" data-cites="chen2015b"><sup><a href="#ref-chen2015b" role="doc-biblioref">5</a></sup></span></td>
</tr>
<tr class="even">
<td>ADD</td>
<td>Plot-based uncertainty</td>
<td>New Zealand</td>
<td>Cross-plot variance greatest magnitude of uncertainty</td>
<td><span class="citation" data-cites="holdaway2014a"><sup><a href="#ref-holdaway2014a" role="doc-biblioref">6</a></sup></span></td>
</tr>
<tr class="odd">
<td>JNR</td>
<td>Multi-scale AGB uncertainty modeling</td>
<td>Minnesota, USA</td>
<td>Cross-scale tests showing effects of spatial resolution on AGB uncertainty.</td>
<td><span class="citation" data-cites="chen2016a"><sup><a href="#ref-chen2016a" role="doc-biblioref">7</a></sup></span></td>
</tr>
<tr class="even">
<td>NA</td>
<td>Allometric uncertainty modeling</td>
<td>Panama</td>
<td>Allometric models identified as largest source of biomass estimation error.</td>
<td><span class="citation" data-cites="chave2004error"><sup><a href="#ref-chave2004error" role="doc-biblioref">8</a></sup></span></td>
</tr>
<tr class="odd">
<td>ADD</td>
<td>Sampling and allometric uncertainty</td>
<td>Tapajos Nat Forest, Brazil</td>
<td>Significance of allometric models on uncertainty of root biomass, 95% CI, 21 plots.</td>
<td><span class="citation" data-cites="keller2001a"><sup><a href="#ref-keller2001a" role="doc-biblioref">9</a></sup></span></td>
</tr>
<tr class="even">
<td>ADD</td>
<td>Uncertainty of volume estimates</td>
<td>Santa Catarina, Brazil</td>
<td>Negligible effects of residual uncertainty on large-area estimates</td>
<td><span class="citation" data-cites="mcroberts2015a"><sup><a href="#ref-mcroberts2015a" role="doc-biblioref">10</a></sup></span></td>
</tr>
<tr class="odd">
<td>NA</td>
<td>Uncertainty metrics in model selection</td>
<td>Oregon, USA</td>
<td>Uncertainty estimates call for local validation or new local model development</td>
<td><span class="citation" data-cites="melson2011a"><sup><a href="#ref-melson2011a" role="doc-biblioref">11</a></sup></span></td>
</tr>
<tr class="even">
<td>ADD</td>
<td>AGB model uncertainty</td>
<td>French Guiana</td>
<td>AGB sub-model errors dominate uncertainty; height and wood-specific gravity errors are minor but can cause bias.</td>
<td><span class="citation" data-cites="molto2013a"><sup><a href="#ref-molto2013a" role="doc-biblioref">12</a></sup></span></td>
</tr>
<tr class="odd">
<td>IFM</td>
<td>Emission factor uncertainty</td>
<td>Central Africa</td>
<td>Model selection is the largest error source (40%); weighting models reduces uncertainty in emission factors.</td>
<td><span class="citation" data-cites="picard2015a"><sup><a href="#ref-picard2015a" role="doc-biblioref">13</a></sup></span></td>
</tr>
<tr class="even">
<td>NA</td>
<td>Uncertainty in ecosystem nutrient estimate</td>
<td>New Hampshire, USA</td>
<td>Identified 8% uncertainty in nitrogen budgets, mainly from plot variability (6%) and allometric errors (5%).</td>
<td><span class="citation" data-cites="yanai2010a"><sup><a href="#ref-yanai2010a" role="doc-biblioref">14</a></sup></span></td>
</tr>
</tbody>
</table>

</section>
</section>
</section>
<aside id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>ADD: Avoided Deforestation and Degradation, JNR: Jurisdictional &amp; Nested REDD+, IFM: Improved Forest Management<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</aside>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body" role="list">
<div id="ref-artREDDEnvironmentalExcellence2021" class="csl-entry" role="listitem">
<div class="csl-left-margin">(1) </div><div class="csl-right-inline">ART, S. <em>The <span>REDD</span>+ <span>Environmental Excellence Standard</span></em>; 2021. <a href="https://www.artredd.org/wp-content/uploads/2021/12/TREES-2.0-August-2021-Clean.pdf">https://www.artredd.org/wp-content/uploads/2021/12/TREES-2.0-August-2021-Clean.pdf</a>.</div>
</div>
<div id="ref-duncansonAbovegroundWoodyBiomass2021" class="csl-entry" role="listitem">
<div class="csl-left-margin">(2) </div><div class="csl-right-inline">Duncanson, L.; Disney, M.; Armston, J.; Nickeson, J.; Minor, D.; Camacho, F. Aboveground <span>Woody Biomass Product Validation Good Practices Protocol</span>. <strong>2021</strong>. <a href="https://doi.org/10.5067/DOC/CEOSWGCV/LPV/AGB.001">https://doi.org/10.5067/DOC/CEOSWGCV/LPV/AGB.001</a>.</div>
</div>
<div id="ref-brown1995a" class="csl-entry" role="listitem">
<div class="csl-left-margin">(3) </div><div class="csl-right-inline">Brown, I. F.; Foster Brown, I.; Martinelli, L. A.; Wayt Thomas, W.; Moreira, M. Z.; Cid Ferreira, C. A.; Victoria, R. A. Uncertainty in the Biomass of Amazonian Forests: <span>An</span> Example from Rondônia, Brazil. <em>Forest Ecology and Management</em> <strong>1995</strong>, <em>75</em> (1–3), 175–189. <a href="https://doi.org/10.1016/0378-1127(94)03512-u">https://doi.org/10.1016/0378-1127(94)03512-u</a>.</div>
</div>
<div id="ref-cohen2013a" class="csl-entry" role="listitem">
<div class="csl-left-margin">(4) </div><div class="csl-right-inline">Cohen, R.; Kaino, J.; Okello, J. A.; Bosire, J. O.; Kairo, J. G.; Huxham, M.; Mencuccini, M. Uncertainty to Estimates of Above-Ground Biomass for <span>Kenyan</span> Mangroves: <span>A</span> Scaling Procedure from Tree to Landscape Level. In <em>Forest ecology and management</em>; 2013; Vol. 310, pp 968–982. <a href="https://doi.org/10.1016/j.foreco.2013.09.047">https://doi.org/10.1016/j.foreco.2013.09.047</a>.</div>
</div>
<div id="ref-chen2015b" class="csl-entry" role="listitem">
<div class="csl-left-margin">(5) </div><div class="csl-right-inline">Chen, Q.; Laurin, G. V.; Valentini, R. Uncertainty of Remotely Sensed Aboveground Biomass over an <span>African</span> Tropical Forest: <span>Propagating</span> Errors from Trees to Plots to Pixels. <em>Remote Sensing of Environment</em> <strong>2015</strong>, <em>160</em>, 134–143. <a href="https://doi.org/10.1016/j.rse.2015.01.009">https://doi.org/10.1016/j.rse.2015.01.009</a>.</div>
</div>
<div id="ref-holdaway2014a" class="csl-entry" role="listitem">
<div class="csl-left-margin">(6) </div><div class="csl-right-inline">Holdaway, R. J.; McNeill, S. J.; Mason, N. W. H.; Carswell, F. E. Propagating Uncertainty in Plot-Based Estimates of Forest Carbon Stock and Carbon Stock Change. <em>Ecosystems</em> <strong>2014</strong>, <em>17</em>, 627–640. <a href="https://doi.org/10.1007/s10021-014-9749-5">https://doi.org/10.1007/s10021-014-9749-5</a>.</div>
</div>
<div id="ref-chen2016a" class="csl-entry" role="listitem">
<div class="csl-left-margin">(7) </div><div class="csl-right-inline">Chen, Q.; McRoberts, R. E.; Wang, C.; Radtke, P. J. Forest Aboveground Biomass Mapping and Estimation Across Multiple Spatial Scales Using Model-Based Inference. <em>Remote Sensing of Environment</em> <strong>2016</strong>, <em>184</em>, 350–360. <a href="https://doi.org/10.1016/j.rse.2016.07.023">https://doi.org/10.1016/j.rse.2016.07.023</a>.</div>
</div>
<div id="ref-chave2004error" class="csl-entry" role="listitem">
<div class="csl-left-margin">(8) </div><div class="csl-right-inline">Chave, J.; Condit, R.; Aguilar, S.; Hernandez, A.; Lao, S.; Perez, R. Error Propagation and Scaling for Tropical Forest Biomass Estimates. <em>Philosophical Transactions of the Royal Society of London. Series B: Biological Sciences</em> <strong>2004</strong>, <em>359</em> (1443), 409–420.</div>
</div>
<div id="ref-keller2001a" class="csl-entry" role="listitem">
<div class="csl-left-margin">(9) </div><div class="csl-right-inline">Keller, M.; Palace, M.; Hurtt, G. Biomass Estimation in the Tapajos National Forest, Brazil. <em>Forest Ecology and Management</em> <strong>2001</strong>, <em>154</em>, 371–382.</div>
</div>
<div id="ref-mcroberts2015a" class="csl-entry" role="listitem">
<div class="csl-left-margin">(10) </div><div class="csl-right-inline">McRoberts, R. E.; Moser, P.; Oliveira, L. Z.; Vibrans, A. C. A General Method for Assessing the Effects of Uncertainty in Individual-Tree Volume Model Predictions on Large-Area Volume Estimates 222 with a Subtropical Forest Illustration. <em>Canadian Journal of Forest Research</em> <strong>2015</strong>, <em>45</em>.</div>
</div>
<div id="ref-melson2011a" class="csl-entry" role="listitem">
<div class="csl-left-margin">(11) </div><div class="csl-right-inline">Melson, S. L.; Harmon, M. E.; Fried, J. S.; Domingo, J. B. Estimates of Live-Tree Carbon Stores in the <span>Pacific Northwest</span> Are Sensitive to Model Selection. <em>Carbon Balance and Management</em> <strong>2011</strong>, <em>6</em>, 2.</div>
</div>
<div id="ref-molto2013a" class="csl-entry" role="listitem">
<div class="csl-left-margin">(12) </div><div class="csl-right-inline">Molto, Q.; Rossi, V.; Blanc, L. Error Propagation in Biomass Estimation in Tropical Forests. <em>Methods in Ecology and Evolution</em> <strong>2013</strong>, <em>4</em>, 175–183. <a href="https://doi.org/10.1111/j.2041-210x.2012.00266.x">https://doi.org/10.1111/j.2041-210x.2012.00266.x</a>.</div>
</div>
<div id="ref-picard2015a" class="csl-entry" role="listitem">
<div class="csl-left-margin">(13) </div><div class="csl-right-inline">Picard, N.; Bosela, F. B.; Rossi, V. Reducing the Error in Biomass Estimates Strongly Depends on Model Selection. <em>Annals of Forest Science</em> <strong>2015</strong>, <em>72</em> (6), 811–823. <a href="https://doi.org/10.1007/s13595-014-0434-9">https://doi.org/10.1007/s13595-014-0434-9</a>.</div>
</div>
<div id="ref-yanai2010a" class="csl-entry" role="listitem">
<div class="csl-left-margin">(14) </div><div class="csl-right-inline">Yanai, R. D.; Battles, J. J.; Richardson, A. D.; Blodgett, C. A.; Wood, D. M.; Rastetter, E. B. Estimating Uncertainty in Ecosystem Budget Calculations. <em>Ecosystems</em> <strong>2010</strong>, <em>13</em>, 239–248. <a href="https://doi.org/10.1007/s10021-010-9315-8">https://doi.org/10.1007/s10021-010-9315-8</a>.</div>
</div>
</div></section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>